https://zh.wikipedia.org/wiki/GUID%E7%A3%81%E7%A2%9F%E5%88%86%E5%89%B2%E8%A1%A8

GUID磁碟分割表(GUID Partition Table, 缩写: GPT)是一个**实体硬盘的分区表的结构布局**的标准. 它是可扩展固件接口(EFI)标准(被Intel用于替代个人计算机的BIOS)的一部分, 被用于替代BIOS系统中的一32bits来存储逻辑块地址和大小信息的主启动记录(MBR)分区表. 

- 对于那些扇区为512字节的磁盘, **MBR分区表不支持容量大于2.2TB(2.2×10\^12字节)的分区(每个分区容量不大于2.2TB)**, 然而, 一些硬盘制造商(诸如希捷和西部数据)注意到这个局限性, 并且将他们的容量较大的磁盘升级到**4KB的扇区**, 这意味着MBR的有效容量上限**提升到16TB**. 这个看似“正确的”解决方案, 在临时地降低人们对改进磁盘分配表的需求的同时, 也给市场带来关于在有较大的块(block)的设备上从BIOS启动时, 如何最佳的划分磁盘分区的困惑. 

- GPT分配64bits(64位)给逻辑块地址, 因而使得最大分区大小在(2\^64)-1个扇区成为可能. 对于每个扇区大小为512字节的磁盘, 那意味着可以有9.4ZB(9.4×10\^21字节)或8 ZiB个512字节(9,444,732,965,739,290,426,880字节或18,446,744,073,709,551,615((2\^64)-1)个扇区×512(2\^9)字节每扇区). 

截止至2010年, 大多数操作系统对GPT均有所支持, 尽管包括Mac OS X和Windows在内的一些仅支持在EFI基础上自GPT分区启动, 见[#操作系统支持](https://zh.wikipedia.org/wiki/GUID%E7%A3%81%E7%A2%9F%E5%88%86%E5%89%B2%E8%A1%A8#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%94%AF%E6%8C%81). 

![config](images/19.png)

GPT分区表的结构. 此例中, 每个逻辑块(LBA)为512字节, 每个分区的记录为128字节. 负数的LBA地址表示从最后的块开始倒数, −1表示最后一个块. 

1. 特点
2. 传统MBR (LBA 0)
3. 分区表头(LBA 1)
4. 分区表项(LBA 2–33)
5. 操作系统支持
    5.1 类Unix操作系统
    5.2 32位Windows
    5.3 64位Windows
6. 分区类型GUID
7. 参见
8. 外部链接
9. 备注
10. 参考资料

## 1. 特点

在MBR硬盘中, 分区信息直接存储于主引导记录(MBR)中(主引导记录中还存储着系统的引导程序). 但在GPT硬盘中, **分区表的位置信息储存在GPT头中**. 但出于兼容性考虑, **硬盘的第一个扇区仍然用作MBR**, 之后才是GPT头. 

跟现代的MBR一样, GPT也使用逻辑区块地址(LBA)取代了早期的CHS寻址方式. **传统MBR信息存储于LBA 0, GPT头存储于LBA 1, 接下来才是分区表本身**. 64位Windows操作系统使用16,384字节(或32扇区)作为GPT分区表, 接下来的**LBA 34是硬盘上第一个分区的开始**. 

苹果公司曾经警告说: “不要假定所有设备的块大小都是512字节. ”一些现代的存储设备如固态硬盘可能使用1024字节的块, 一些磁光盘(MO)可能使用2048字节的扇区(但是磁光盘通常是不进行分区的). 一些硬盘生产商在计划生产4096字节一个扇区的硬盘, 但截至2010年初, 这种新硬盘使用固件对操作系统伪装成512字节一个扇区. 

使用英特尔架构的苹果机也使用GPT. 

为了减少分区表损坏的风险, GPT在硬盘最后保存了一份分区表的副本. 

## 2. 传统MBR (LBA 0)

在GPT分区表的最开头, 出于兼容性考虑仍然存储了一份传统的MBR, 用来防止不支持GPT的硬盘管理工具错误识别并破坏硬盘中的数据, 这个MBR也叫做**保护MBR**. 在支持**从GPT启动的操作系统**中, 这里也用于存储第一阶段的启动代码. 在这个MBR中, **只有一个标识为0xEE的分区**, 以此来**表示这块硬盘使用GPT分区表, 这个分区类型是PMBR**. 不能识别GPT硬盘的操作系统通常会识别出一个未知类型的分区, 并且拒绝对硬盘进行操作, 除非用户特别要求删除这个分区. 这就避免了意外删除分区的危险. 另外, 能够识别GPT分区表的操作系统会检查保护MBR中的分区表, 如果分区类型不是0xEE或者MBR分区表中有多个项, 也会拒绝对硬盘进行操作. 

在使用MBR/GPT混合分区表的硬盘中, 这部分存储了GPT分区表的一部分分区(通常是前四个分区), 可以使不支持从GPT启动的操作系统从这个MBR启动, 启动后只能操作MBR分区表中的分区. 如Boot Camp就是使用这种方式启动Windows. 

## 3. 分区表头(LBA 1)

分区表头定义了**硬盘的可用空间**以及**组成分区表的项的大小和数量**. 在使用64位Windows Server 2003的机器上, 最多可以创建128个分区, 即分区表中保留了128个项, 其中每个都是128字节. (EFI标准要求分区表最小要有16,384字节, 即128个分区项的大小)

分区表头还记录了这块硬盘的GUID, 记录了分区表头本身的位置和大小(位置总是在LBA 1)以及备份分区表头和分区表的位置和大小(在硬盘的最后). 它还储存着**它本身和分区表的CRC32校验**. 固件、引导程序和操作系统在启动时可以根据这个校验值来判断分区表是否出错, 如果出错了, 可以使用软件从硬盘最后的备份GPT中恢复整个分区表, 如果备份GPT也校验错误, 硬盘将不可使用. 所以GPT硬盘的分区表**不可以直接使用16进制编辑器修改**. 

![config](images/20.png)

主分区表和备份分区表的头分别位于硬盘的第二个扇区(LBA 1)以及硬盘的最后一个扇区. 备份分区表头中的信息是关于备份分区表的. 

## 4. 分区表项(LBA 2–33)

GPT分区表使用简单而直接的方式表示分区. 一个分区表项的前16字节是分区类型GUID. 例如, EFI系统分区的GUID类型是{C12A7328-F81F-11D2-BA4B-00A0C93EC93B}. 接下来的16字节是该分区唯一的GUID(这个GUID指的是该分区本身, 而之前的GUID指的是该分区的类型). 再接下来是分区起始和末尾的64位LBA编号, 以及分区的名字和属性. 

![config](images/21.png)
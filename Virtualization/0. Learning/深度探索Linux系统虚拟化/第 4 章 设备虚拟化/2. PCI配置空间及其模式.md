
PCI标准约定, 每个PCI设备都需要实现一个称为配置空间(Configuration Space)的结构, 该结构就是若干寄存器的集合, 其大小为256字节, 包括预定义头部(predefined header region)和设备相关部分(device dependent region), 预定义头部占据64字节, 其余192字节为设备相关部分. 预定义头部定义了PCI设备的基本信息以及通用控制相关部分, 包括Vendor ID、Device ID等, 其中Vendor ID是唯一的, 由PCI特别兴趣小组(PCI SIG)统一负责分配. 在Linux内核中, PCI设备驱动就是通过Device ID和Vendor ID来匹配设备的. 所有PCI设备的预定义头部的前16字节完全相同, 16～63字节的内容则依具体的PCI设备类型而定. 位于配置空间中的偏移0x0E处的寄存器Header Type定义了PCI设备的类型, 00h为普通PCI设备, 01h为PCI桥, 02h为CardBus桥. 图4-4为普通PCI设备的预定义头部.
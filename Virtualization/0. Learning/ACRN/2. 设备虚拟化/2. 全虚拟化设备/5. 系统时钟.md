
ACRN支持实时时钟(Real Time Clock，RTC)、可编程时钟(Programmable Interval Timer，PIT)和高精度事件时钟(High Precision Event Timer，HPET)作为系统时钟。相比RTC和PIT，HPET有更高的分辨率。

系统时钟虚拟化架构如图所示。

![2024-10-24-11-00-07.png](./images/2024-10-24-11-00-07.png)

通过对端口I/O和MMIO的模拟，客户机可以看到vRTC、vPIT和vHPET。当客户机访问这些端口I/O和MMIO时，ACRN会截获这些访问并将其转给ACRN设备模型来处理。

系统时钟在设备模型中的初始化在vm_init_vdevs函数中完成，其初始化函数分别是vrtc_init、vpit_init和vhpet_init，代码如下所示：

```cpp
static int
vm_init_vdevs(struct vmctx *ctx)
{
    ...
	ret = vrtc_init(ctx);

	ret = vpit_init(ctx);

	ret = vhpet_init(ctx);
    ...
}
```

# PIT 模拟


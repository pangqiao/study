
ACRN Hypervisor 触发安全状态转换是调用板级支持包 (Board Support Package,BSP) 提供的错误处理接口. 一旦检测到不可恢复的错误, ACRN Hypervisor 即调用 BSP 错误处理接口, 这里假定在用户提供的处理接口中进行相应处理并让系统转入安全状态.

ACRN Hypervisor 可检测的不可恢复错误包括:

* Bootloader 提供的启动信息错误;

* Hypervisor 中非预期的异常或中断;

* 硬件信息错误;

* 硬件操作等待超时(例如, 处理器核启动, IOMMU 操作, RTC 操作)​.

虚拟机触发的异常行为一般不认为是不可恢复的. 具体来说, 下列错误不会引起 ACRN Hypervisor 触发安全状态转换.

* 某个虚拟机访问了不允许访问的内存. 当虚拟机直接访问不允许访问的内存区域时, ACRN Hypervisor 会给访存的虚拟处理器注入一个页故障异常. 虚拟机中的客户操作系统决定如何处理页故障异常. 当虚拟机通过 DMA 间接访问不允许访问的内存区域时, 虚拟机会收到和真实物理硬件操作一样的异常.

* 虚拟机直接触发的异常会被注回到虚拟机, 虚拟机接收异常后做进一步处理.
